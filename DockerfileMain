# docker build -f ./DockerfileMain -t rish889/rish-spring-shop:0.0.1-SNAPSHOT .
# docker run -p 8080:8080 -t modulith-web

FROM maven:3.8.6-openjdk-18 as maven_build
WORKDIR /app
COPY ./ .
RUN --mount=type=cache,target=/root/.m2  mvn clean package -f ./pom.xml

FROM openjdk:18
WORKDIR /app
COPY --from=maven_build /app/target/rishShop-0.0.1-SNAPSHOT.jar ./target/rishShop-0.0.1-SNAPSHOT.jar
EXPOSE 8080
ENTRYPOINT ["java","-jar","/app/target/rishShop-0.0.1-SNAPSHOT.jar"]

# sudo DOCKER_BUILDKIT=1 docker build -f ./DockerfileWeb -t modulith-web .

# JAVA_HOME=/home/rishabh/software/jdk-18.0.2.1_linux-x64_bin/jdk-18.0.2.1
# mvn clean install -DskipTests
# mvn clean package -DskipTests
# java -jar web/target/web-0.0.1-SNAPSHOT.jar